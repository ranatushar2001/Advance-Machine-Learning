% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\newsavebox\pandoc@box
\newcommand*\pandocbounded[1]{% scales image to fit in text height/width
  \sbox\pandoc@box{#1}%
  \Gscale@div\@tempa{\textheight}{\dimexpr\ht\pandoc@box+\dp\pandoc@box\relax}%
  \Gscale@div\@tempb{\linewidth}{\wd\pandoc@box}%
  \ifdim\@tempb\p@<\@tempa\p@\let\@tempa\@tempb\fi% select the smaller of both
  \ifdim\@tempa\p@<\p@\scalebox{\@tempa}{\usebox\pandoc@box}%
  \else\usebox{\pandoc@box}%
  \fi%
}
% Set default figure placement to htbp
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\usepackage{bookmark}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={Assignment1\_AML},
  pdfauthor={Tushar Rana},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{Assignment1\_AML}
\author{Tushar Rana}
\date{2025-09-21}

\begin{document}
\maketitle

Step 1: Install \& Load Libraries

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#install.packages("keras3")}
\FunctionTok{library}\NormalTok{(keras3)}
\end{Highlighting}
\end{Shaded}

Step 2: Load and Preprocess Data

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Load IMDB dataset}
\NormalTok{max\_features }\OtherTok{\textless{}{-}} \DecValTok{10000}   \CommentTok{\# keep top 10k words}
\NormalTok{maxlen }\OtherTok{\textless{}{-}} \DecValTok{500}           \CommentTok{\# cut texts after 500 words}

\NormalTok{imdb }\OtherTok{\textless{}{-}} \FunctionTok{dataset\_imdb}\NormalTok{(}\AttributeTok{num\_words =}\NormalTok{ max\_features)}
\FunctionTok{c}\NormalTok{(}\FunctionTok{c}\NormalTok{(x\_train, y\_train), }\FunctionTok{c}\NormalTok{(x\_test, y\_test)) }\SpecialCharTok{\%\textless{}{-}\%}\NormalTok{ imdb}

\CommentTok{\# Pad sequences so all reviews are the same length}
\NormalTok{x\_train }\OtherTok{\textless{}{-}} \FunctionTok{pad\_sequences}\NormalTok{(x\_train, }\AttributeTok{maxlen =}\NormalTok{ maxlen)}
\NormalTok{x\_test  }\OtherTok{\textless{}{-}} \FunctionTok{pad\_sequences}\NormalTok{(x\_test,  }\AttributeTok{maxlen =}\NormalTok{ maxlen)}
\end{Highlighting}
\end{Shaded}

Step 3: Baseline Model (2 hidden layers, relu, 16 units)

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{baseline\_model }\OtherTok{\textless{}{-}} \FunctionTok{keras\_model\_sequential}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{layer\_embedding}\NormalTok{(}\AttributeTok{input\_dim =}\NormalTok{ max\_features, }\AttributeTok{output\_dim =} \DecValTok{32}\NormalTok{, }\AttributeTok{input\_length =}\NormalTok{ maxlen) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{layer\_flatten}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{layer\_dense}\NormalTok{(}\AttributeTok{units =} \DecValTok{16}\NormalTok{, }\AttributeTok{activation =} \StringTok{"relu"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{layer\_dense}\NormalTok{(}\AttributeTok{units =} \DecValTok{16}\NormalTok{, }\AttributeTok{activation =} \StringTok{"relu"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{layer\_dense}\NormalTok{(}\AttributeTok{units =} \DecValTok{1}\NormalTok{, }\AttributeTok{activation =} \StringTok{"sigmoid"}\NormalTok{)}

\NormalTok{baseline\_model }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{compile}\NormalTok{(}
  \AttributeTok{optimizer =} \StringTok{"rmsprop"}\NormalTok{,}
  \AttributeTok{loss =} \StringTok{"binary\_crossentropy"}\NormalTok{,}
  \AttributeTok{metrics =} \FunctionTok{c}\NormalTok{(}\StringTok{"accuracy"}\NormalTok{)}
\NormalTok{)}

\NormalTok{history\_baseline }\OtherTok{\textless{}{-}}\NormalTok{ baseline\_model }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{fit}\NormalTok{(}
\NormalTok{  x\_train, y\_train,}
  \AttributeTok{epochs =} \DecValTok{20}\NormalTok{,}
  \AttributeTok{batch\_size =} \DecValTok{512}\NormalTok{,}
  \AttributeTok{validation\_split =} \FloatTok{0.2}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Epoch 1/20
## 40/40 - 1s - 34ms/step - accuracy: 0.5120 - loss: 0.6928 - val_accuracy: 0.4936 - val_loss: 0.6935
## Epoch 2/20
## 40/40 - 1s - 24ms/step - accuracy: 0.5706 - loss: 0.6837 - val_accuracy: 0.5328 - val_loss: 0.6752
## Epoch 3/20
## 40/40 - 1s - 24ms/step - accuracy: 0.6637 - loss: 0.6345 - val_accuracy: 0.7094 - val_loss: 0.6096
## Epoch 4/20
## 40/40 - 1s - 25ms/step - accuracy: 0.7271 - loss: 0.5587 - val_accuracy: 0.7098 - val_loss: 0.5505
## Epoch 5/20
## 40/40 - 1s - 24ms/step - accuracy: 0.7994 - loss: 0.4340 - val_accuracy: 0.6858 - val_loss: 0.5886
## Epoch 6/20
## 40/40 - 1s - 24ms/step - accuracy: 0.8303 - loss: 0.3790 - val_accuracy: 0.7944 - val_loss: 0.4270
## Epoch 7/20
## 40/40 - 1s - 24ms/step - accuracy: 0.8585 - loss: 0.3331 - val_accuracy: 0.8342 - val_loss: 0.3703
## Epoch 8/20
## 40/40 - 1s - 24ms/step - accuracy: 0.8759 - loss: 0.3014 - val_accuracy: 0.8264 - val_loss: 0.3897
## Epoch 9/20
## 40/40 - 1s - 24ms/step - accuracy: 0.9116 - loss: 0.2263 - val_accuracy: 0.8402 - val_loss: 0.3619
## Epoch 10/20
## 40/40 - 1s - 24ms/step - accuracy: 0.9232 - loss: 0.2011 - val_accuracy: 0.8242 - val_loss: 0.3853
## Epoch 11/20
## 40/40 - 1s - 24ms/step - accuracy: 0.9431 - loss: 0.1589 - val_accuracy: 0.8282 - val_loss: 0.4371
## Epoch 12/20
## 40/40 - 1s - 24ms/step - accuracy: 0.9514 - loss: 0.1366 - val_accuracy: 0.8404 - val_loss: 0.3888
## Epoch 13/20
## 40/40 - 1s - 24ms/step - accuracy: 0.9670 - loss: 0.1050 - val_accuracy: 0.8420 - val_loss: 0.4112
## Epoch 14/20
## 40/40 - 1s - 24ms/step - accuracy: 0.9803 - loss: 0.0732 - val_accuracy: 0.8392 - val_loss: 0.4302
## Epoch 15/20
## 40/40 - 1s - 24ms/step - accuracy: 0.9834 - loss: 0.0579 - val_accuracy: 0.8346 - val_loss: 0.4727
## Epoch 16/20
## 40/40 - 1s - 24ms/step - accuracy: 0.9945 - loss: 0.0297 - val_accuracy: 0.8398 - val_loss: 0.4978
## Epoch 17/20
## 40/40 - 1s - 24ms/step - accuracy: 0.9183 - loss: 0.2281 - val_accuracy: 0.8276 - val_loss: 0.4312
## Epoch 18/20
## 40/40 - 1s - 24ms/step - accuracy: 0.9764 - loss: 0.0710 - val_accuracy: 0.8238 - val_loss: 0.5928
## Epoch 19/20
## 40/40 - 1s - 24ms/step - accuracy: 0.9772 - loss: 0.0561 - val_accuracy: 0.8244 - val_loss: 0.5978
## Epoch 20/20
## 40/40 - 1s - 24ms/step - accuracy: 0.9986 - loss: 0.0091 - val_accuracy: 0.8250 - val_loss: 0.6498
\end{verbatim}

Step 4: Variations You Need to Test 1. Vary Number of Hidden Layers

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# One hidden layer}
\NormalTok{model\_1layer }\OtherTok{\textless{}{-}} \FunctionTok{keras\_model\_sequential}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{layer\_embedding}\NormalTok{(max\_features, }\DecValTok{32}\NormalTok{, }\AttributeTok{input\_length =}\NormalTok{ maxlen) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{layer\_flatten}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{layer\_dense}\NormalTok{(}\AttributeTok{units =} \DecValTok{16}\NormalTok{, }\AttributeTok{activation =} \StringTok{"relu"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{layer\_dense}\NormalTok{(}\AttributeTok{units =} \DecValTok{1}\NormalTok{, }\AttributeTok{activation =} \StringTok{"sigmoid"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Three hidden layers}
\NormalTok{model\_3layer }\OtherTok{\textless{}{-}} \FunctionTok{keras\_model\_sequential}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{layer\_embedding}\NormalTok{(max\_features, }\DecValTok{32}\NormalTok{, }\AttributeTok{input\_length =}\NormalTok{ maxlen) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{layer\_flatten}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{layer\_dense}\NormalTok{(}\AttributeTok{units =} \DecValTok{16}\NormalTok{, }\AttributeTok{activation =} \StringTok{"relu"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{layer\_dense}\NormalTok{(}\AttributeTok{units =} \DecValTok{16}\NormalTok{, }\AttributeTok{activation =} \StringTok{"relu"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{layer\_dense}\NormalTok{(}\AttributeTok{units =} \DecValTok{16}\NormalTok{, }\AttributeTok{activation =} \StringTok{"relu"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{layer\_dense}\NormalTok{(}\AttributeTok{units =} \DecValTok{1}\NormalTok{, }\AttributeTok{activation =} \StringTok{"sigmoid"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  Vary Units (32, 64, etc.)
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model\_units }\OtherTok{\textless{}{-}} \FunctionTok{keras\_model\_sequential}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{layer\_embedding}\NormalTok{(max\_features, }\DecValTok{32}\NormalTok{, }\AttributeTok{input\_length =}\NormalTok{ maxlen) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{layer\_flatten}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{layer\_dense}\NormalTok{(}\AttributeTok{units =} \DecValTok{64}\NormalTok{, }\AttributeTok{activation =} \StringTok{"relu"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}   \CommentTok{\# Try 32, 64, 128}
  \FunctionTok{layer\_dense}\NormalTok{(}\AttributeTok{units =} \DecValTok{1}\NormalTok{, }\AttributeTok{activation =} \StringTok{"sigmoid"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  Change Loss Function to MSE
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model\_mse }\OtherTok{\textless{}{-}} \FunctionTok{keras\_model\_sequential}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{layer\_embedding}\NormalTok{(max\_features, }\DecValTok{32}\NormalTok{, }\AttributeTok{input\_length =}\NormalTok{ maxlen) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{layer\_flatten}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{layer\_dense}\NormalTok{(}\AttributeTok{units =} \DecValTok{16}\NormalTok{, }\AttributeTok{activation =} \StringTok{"relu"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{layer\_dense}\NormalTok{(}\AttributeTok{units =} \DecValTok{1}\NormalTok{, }\AttributeTok{activation =} \StringTok{"sigmoid"}\NormalTok{)}

\NormalTok{model\_mse }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{compile}\NormalTok{(}
  \AttributeTok{optimizer =} \StringTok{"rmsprop"}\NormalTok{,}
  \AttributeTok{loss =} \StringTok{"mse"}\NormalTok{,   }\CommentTok{\# 👈 Mean Squared Error}
  \AttributeTok{metrics =} \FunctionTok{c}\NormalTok{(}\StringTok{"accuracy"}\NormalTok{)}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{3}
\tightlist
\item
  Change Activation to Tanh
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model\_tanh }\OtherTok{\textless{}{-}} \FunctionTok{keras\_model\_sequential}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{layer\_embedding}\NormalTok{(max\_features, }\DecValTok{32}\NormalTok{, }\AttributeTok{input\_length =}\NormalTok{ maxlen) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{layer\_flatten}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{layer\_dense}\NormalTok{(}\AttributeTok{units =} \DecValTok{16}\NormalTok{, }\AttributeTok{activation =} \StringTok{"tanh"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}   \CommentTok{\# 👈 tanh}
  \FunctionTok{layer\_dense}\NormalTok{(}\AttributeTok{units =} \DecValTok{16}\NormalTok{, }\AttributeTok{activation =} \StringTok{"tanh"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{layer\_dense}\NormalTok{(}\AttributeTok{units =} \DecValTok{1}\NormalTok{, }\AttributeTok{activation =} \StringTok{"sigmoid"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{4}
\tightlist
\item
  Add Dropout / Regularization
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model\_dropout }\OtherTok{\textless{}{-}} \FunctionTok{keras\_model\_sequential}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{layer\_embedding}\NormalTok{(max\_features, }\DecValTok{32}\NormalTok{, }\AttributeTok{input\_length =}\NormalTok{ maxlen) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{layer\_flatten}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{layer\_dense}\NormalTok{(}\AttributeTok{units =} \DecValTok{64}\NormalTok{, }\AttributeTok{activation =} \StringTok{"relu"}\NormalTok{, }\AttributeTok{kernel\_regularizer =} \FunctionTok{regularizer\_l2}\NormalTok{(}\FloatTok{0.001}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{layer\_dropout}\NormalTok{(}\AttributeTok{rate =} \FloatTok{0.5}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}   \CommentTok{\# 👈 Dropout layer}
  \FunctionTok{layer\_dense}\NormalTok{(}\AttributeTok{units =} \DecValTok{64}\NormalTok{, }\AttributeTok{activation =} \StringTok{"relu"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{layer\_dense}\NormalTok{(}\AttributeTok{units =} \DecValTok{1}\NormalTok{, }\AttributeTok{activation =} \StringTok{"sigmoid"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Step 5: Compare Results For each model: Example with baseline model

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{history\_baseline }\OtherTok{\textless{}{-}}\NormalTok{ baseline\_model }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{fit}\NormalTok{(}
\NormalTok{  x\_train, y\_train,}
  \AttributeTok{epochs =} \DecValTok{20}\NormalTok{,}
  \AttributeTok{batch\_size =} \DecValTok{512}\NormalTok{,}
  \AttributeTok{validation\_split =} \FloatTok{0.2}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Epoch 1/20
## 40/40 - 1s - 25ms/step - accuracy: 0.9992 - loss: 0.0051 - val_accuracy: 0.8236 - val_loss: 0.7116
## Epoch 2/20
## 40/40 - 1s - 24ms/step - accuracy: 0.9995 - loss: 0.0029 - val_accuracy: 0.8224 - val_loss: 0.7837
## Epoch 3/20
## 40/40 - 1s - 24ms/step - accuracy: 0.9998 - loss: 0.0018 - val_accuracy: 0.8224 - val_loss: 0.8401
## Epoch 4/20
## 40/40 - 1s - 24ms/step - accuracy: 0.9998 - loss: 8.9755e-04 - val_accuracy: 0.8238 - val_loss: 0.9050
## Epoch 5/20
## 40/40 - 1s - 24ms/step - accuracy: 1.0000 - loss: 5.2799e-04 - val_accuracy: 0.8234 - val_loss: 0.9541
## Epoch 6/20
## 40/40 - 1s - 24ms/step - accuracy: 1.0000 - loss: 2.5849e-04 - val_accuracy: 0.8226 - val_loss: 0.9927
## Epoch 7/20
## 40/40 - 1s - 24ms/step - accuracy: 1.0000 - loss: 2.2566e-04 - val_accuracy: 0.8230 - val_loss: 1.0289
## Epoch 8/20
## 40/40 - 1s - 24ms/step - accuracy: 1.0000 - loss: 1.7814e-04 - val_accuracy: 0.8234 - val_loss: 1.0601
## Epoch 9/20
## 40/40 - 1s - 24ms/step - accuracy: 1.0000 - loss: 1.0710e-04 - val_accuracy: 0.8210 - val_loss: 1.1041
## Epoch 10/20
## 40/40 - 1s - 24ms/step - accuracy: 1.0000 - loss: 1.0986e-04 - val_accuracy: 0.8244 - val_loss: 1.1043
## Epoch 11/20
## 40/40 - 1s - 24ms/step - accuracy: 1.0000 - loss: 8.8055e-05 - val_accuracy: 0.8246 - val_loss: 1.1251
## Epoch 12/20
## 40/40 - 1s - 24ms/step - accuracy: 1.0000 - loss: 6.4851e-05 - val_accuracy: 0.8246 - val_loss: 1.1403
## Epoch 13/20
## 40/40 - 1s - 24ms/step - accuracy: 1.0000 - loss: 5.4253e-05 - val_accuracy: 0.8246 - val_loss: 1.1559
## Epoch 14/20
## 40/40 - 1s - 25ms/step - accuracy: 1.0000 - loss: 4.9194e-05 - val_accuracy: 0.8252 - val_loss: 1.1689
## Epoch 15/20
## 40/40 - 1s - 24ms/step - accuracy: 1.0000 - loss: 4.3381e-05 - val_accuracy: 0.8244 - val_loss: 1.1875
## Epoch 16/20
## 40/40 - 1s - 24ms/step - accuracy: 1.0000 - loss: 4.1124e-05 - val_accuracy: 0.8250 - val_loss: 1.1869
## Epoch 17/20
## 40/40 - 1s - 24ms/step - accuracy: 1.0000 - loss: 3.4480e-05 - val_accuracy: 0.8242 - val_loss: 1.1963
## Epoch 18/20
## 40/40 - 1s - 24ms/step - accuracy: 1.0000 - loss: 3.2510e-05 - val_accuracy: 0.8242 - val_loss: 1.2057
## Epoch 19/20
## 40/40 - 1s - 24ms/step - accuracy: 1.0000 - loss: 3.0768e-05 - val_accuracy: 0.8254 - val_loss: 1.2131
## Epoch 20/20
## 40/40 - 1s - 24ms/step - accuracy: 1.0000 - loss: 2.7035e-05 - val_accuracy: 0.8258 - val_loss: 1.2208
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{score\_baseline }\OtherTok{\textless{}{-}}\NormalTok{ baseline\_model }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{evaluate}\NormalTok{(x\_test, y\_test)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 782/782 - 0s - 448us/step - accuracy: 0.8230 - loss: 1.2116
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(score\_baseline)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $accuracy
## [1] 0.82304
## 
## $loss
## [1] 1.211599
\end{verbatim}

Example with 1 hidden layer model

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model\_1layer }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{compile}\NormalTok{(}
  \AttributeTok{optimizer =} \StringTok{"rmsprop"}\NormalTok{,}
  \AttributeTok{loss =} \StringTok{"binary\_crossentropy"}\NormalTok{,}
  \AttributeTok{metrics =} \FunctionTok{c}\NormalTok{(}\StringTok{"accuracy"}\NormalTok{)}
\NormalTok{)}

\NormalTok{history\_1layer }\OtherTok{\textless{}{-}}\NormalTok{ model\_1layer }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{fit}\NormalTok{(}
\NormalTok{  x\_train, y\_train,}
  \AttributeTok{epochs =} \DecValTok{20}\NormalTok{,}
  \AttributeTok{batch\_size =} \DecValTok{512}\NormalTok{,}
  \AttributeTok{validation\_split =} \FloatTok{0.2}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Epoch 1/20
## 40/40 - 1s - 32ms/step - accuracy: 0.5016 - loss: 0.6931 - val_accuracy: 0.5084 - val_loss: 0.6927
## Epoch 2/20
## 40/40 - 1s - 24ms/step - accuracy: 0.5417 - loss: 0.6860 - val_accuracy: 0.5374 - val_loss: 0.6859
## Epoch 3/20
## 40/40 - 1s - 24ms/step - accuracy: 0.6020 - loss: 0.6548 - val_accuracy: 0.6936 - val_loss: 0.6127
## Epoch 4/20
## 40/40 - 1s - 24ms/step - accuracy: 0.6988 - loss: 0.5900 - val_accuracy: 0.6012 - val_loss: 0.6287
## Epoch 5/20
## 40/40 - 1s - 25ms/step - accuracy: 0.7829 - loss: 0.4561 - val_accuracy: 0.8014 - val_loss: 0.4333
## Epoch 6/20
## 40/40 - 1s - 25ms/step - accuracy: 0.8421 - loss: 0.3600 - val_accuracy: 0.8256 - val_loss: 0.3822
## Epoch 7/20
## 40/40 - 1s - 24ms/step - accuracy: 0.8685 - loss: 0.3157 - val_accuracy: 0.8210 - val_loss: 0.3951
## Epoch 8/20
## 40/40 - 1s - 24ms/step - accuracy: 0.8791 - loss: 0.2861 - val_accuracy: 0.8144 - val_loss: 0.4125
## Epoch 9/20
## 40/40 - 1s - 24ms/step - accuracy: 0.9054 - loss: 0.2404 - val_accuracy: 0.8294 - val_loss: 0.3826
## Epoch 10/20
## 40/40 - 1s - 24ms/step - accuracy: 0.9242 - loss: 0.1999 - val_accuracy: 0.8348 - val_loss: 0.3759
## Epoch 11/20
## 40/40 - 1s - 24ms/step - accuracy: 0.9408 - loss: 0.1704 - val_accuracy: 0.8404 - val_loss: 0.3789
## Epoch 12/20
## 40/40 - 1s - 24ms/step - accuracy: 0.9552 - loss: 0.1339 - val_accuracy: 0.8442 - val_loss: 0.3794
## Epoch 13/20
## 40/40 - 1s - 24ms/step - accuracy: 0.9661 - loss: 0.1107 - val_accuracy: 0.8380 - val_loss: 0.3925
## Epoch 14/20
## 40/40 - 1s - 25ms/step - accuracy: 0.9755 - loss: 0.0889 - val_accuracy: 0.8328 - val_loss: 0.4210
## Epoch 15/20
## 40/40 - 1s - 25ms/step - accuracy: 0.9895 - loss: 0.0565 - val_accuracy: 0.8434 - val_loss: 0.4067
## Epoch 16/20
## 40/40 - 1s - 24ms/step - accuracy: 0.9933 - loss: 0.0412 - val_accuracy: 0.8358 - val_loss: 0.4620
## Epoch 17/20
## 40/40 - 1s - 25ms/step - accuracy: 0.9795 - loss: 0.0631 - val_accuracy: 0.8342 - val_loss: 0.4377
## Epoch 18/20
## 40/40 - 1s - 24ms/step - accuracy: 0.9955 - loss: 0.0292 - val_accuracy: 0.8268 - val_loss: 0.4968
## Epoch 19/20
## 40/40 - 1s - 25ms/step - accuracy: 0.9878 - loss: 0.0429 - val_accuracy: 0.8290 - val_loss: 0.4971
## Epoch 20/20
## 40/40 - 1s - 25ms/step - accuracy: 0.9981 - loss: 0.0165 - val_accuracy: 0.8314 - val_loss: 0.5073
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{score\_1layer }\OtherTok{\textless{}{-}}\NormalTok{ model\_1layer }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{evaluate}\NormalTok{(x\_test, y\_test)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 782/782 - 0s - 434us/step - accuracy: 0.8366 - loss: 0.5042
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(score\_1layer)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $accuracy
## [1] 0.8366
## 
## $loss
## [1] 0.5041708
\end{verbatim}

Example with Dropout model

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model\_dropout }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{compile}\NormalTok{(}
  \AttributeTok{optimizer =} \StringTok{"rmsprop"}\NormalTok{,}
  \AttributeTok{loss =} \StringTok{"binary\_crossentropy"}\NormalTok{,}
  \AttributeTok{metrics =} \FunctionTok{c}\NormalTok{(}\StringTok{"accuracy"}\NormalTok{)}
\NormalTok{)}

\NormalTok{history\_dropout }\OtherTok{\textless{}{-}}\NormalTok{ model\_dropout }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{fit}\NormalTok{(}
\NormalTok{  x\_train, y\_train,}
  \AttributeTok{epochs =} \DecValTok{20}\NormalTok{,}
  \AttributeTok{batch\_size =} \DecValTok{512}\NormalTok{,}
  \AttributeTok{validation\_split =} \FloatTok{0.2}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Epoch 1/20
## 40/40 - 2s - 42ms/step - accuracy: 0.5091 - loss: 0.7950 - val_accuracy: 0.4938 - val_loss: 0.7713
## Epoch 2/20
## 40/40 - 1s - 32ms/step - accuracy: 0.5403 - loss: 0.7510 - val_accuracy: 0.5908 - val_loss: 0.7273
## Epoch 3/20
## 40/40 - 1s - 33ms/step - accuracy: 0.6351 - loss: 0.6952 - val_accuracy: 0.5886 - val_loss: 0.6902
## Epoch 4/20
## 40/40 - 1s - 32ms/step - accuracy: 0.6195 - loss: 0.7241 - val_accuracy: 0.7600 - val_loss: 0.5725
## Epoch 5/20
## 40/40 - 1s - 32ms/step - accuracy: 0.6757 - loss: 0.7266 - val_accuracy: 0.7196 - val_loss: 0.6093
## Epoch 6/20
## 40/40 - 1s - 32ms/step - accuracy: 0.7602 - loss: 0.5838 - val_accuracy: 0.5438 - val_loss: 0.7506
## Epoch 7/20
## 40/40 - 1s - 33ms/step - accuracy: 0.7092 - loss: 0.6227 - val_accuracy: 0.6952 - val_loss: 0.6622
## Epoch 8/20
## 40/40 - 1s - 33ms/step - accuracy: 0.7954 - loss: 0.4978 - val_accuracy: 0.7924 - val_loss: 0.5182
## Epoch 9/20
## 40/40 - 1s - 33ms/step - accuracy: 0.8647 - loss: 0.3748 - val_accuracy: 0.8084 - val_loss: 0.4865
## Epoch 10/20
## 40/40 - 1s - 33ms/step - accuracy: 0.8900 - loss: 0.3263 - val_accuracy: 0.8372 - val_loss: 0.4409
## Epoch 11/20
## 40/40 - 1s - 33ms/step - accuracy: 0.8422 - loss: 0.4095 - val_accuracy: 0.8416 - val_loss: 0.4418
## Epoch 12/20
## 40/40 - 1s - 32ms/step - accuracy: 0.8578 - loss: 0.4020 - val_accuracy: 0.6064 - val_loss: 0.9581
## Epoch 13/20
## 40/40 - 1s - 33ms/step - accuracy: 0.9024 - loss: 0.3053 - val_accuracy: 0.8420 - val_loss: 0.4502
## Epoch 14/20
## 40/40 - 1s - 33ms/step - accuracy: 0.8946 - loss: 0.3594 - val_accuracy: 0.7892 - val_loss: 0.5882
## Epoch 15/20
## 40/40 - 1s - 33ms/step - accuracy: 0.9370 - loss: 0.2401 - val_accuracy: 0.8324 - val_loss: 0.4794
## Epoch 16/20
## 40/40 - 1s - 33ms/step - accuracy: 0.9647 - loss: 0.1703 - val_accuracy: 0.8484 - val_loss: 0.5008
## Epoch 17/20
## 40/40 - 1s - 33ms/step - accuracy: 0.9743 - loss: 0.1415 - val_accuracy: 0.8370 - val_loss: 0.5904
## Epoch 18/20
## 40/40 - 1s - 33ms/step - accuracy: 0.8697 - loss: 0.8937 - val_accuracy: 0.5354 - val_loss: 0.7202
## Epoch 19/20
## 40/40 - 1s - 33ms/step - accuracy: 0.7625 - loss: 0.5401 - val_accuracy: 0.8486 - val_loss: 0.5066
## Epoch 20/20
## 40/40 - 1s - 33ms/step - accuracy: 0.9582 - loss: 0.1899 - val_accuracy: 0.8384 - val_loss: 0.6762
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{score\_dropout }\OtherTok{\textless{}{-}}\NormalTok{ model\_dropout }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{evaluate}\NormalTok{(x\_test, y\_test)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 782/782 - 1s - 1ms/step - accuracy: 0.8432 - loss: 0.6569
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(score\_dropout)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $accuracy
## [1] 0.8432
## 
## $loss
## [1] 0.6569284
\end{verbatim}

Plot 1) Lightweight base-R plot (robust to acc / accuracy)

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{plot\_history }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(history, }\AttributeTok{metric =} \FunctionTok{c}\NormalTok{(}\StringTok{"accuracy"}\NormalTok{, }\StringTok{"loss"}\NormalTok{)) \{}
\NormalTok{  metric }\OtherTok{\textless{}{-}} \FunctionTok{match.arg}\NormalTok{(metric)}
\NormalTok{  metrics }\OtherTok{\textless{}{-}}\NormalTok{ history}\SpecialCharTok{$}\NormalTok{metrics}
  
  \CommentTok{\# detect accuracy name}
\NormalTok{  acc\_name }\OtherTok{\textless{}{-}} \ControlFlowTok{if}\NormalTok{ (}\SpecialCharTok{!}\FunctionTok{is.null}\NormalTok{(metrics}\SpecialCharTok{$}\NormalTok{accuracy)) }\StringTok{"accuracy"} \ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{ (}\SpecialCharTok{!}\FunctionTok{is.null}\NormalTok{(metrics}\SpecialCharTok{$}\NormalTok{acc)) }\StringTok{"acc"} \ControlFlowTok{else} \ConstantTok{NULL}
  \ControlFlowTok{if}\NormalTok{ (metric }\SpecialCharTok{==} \StringTok{"accuracy"} \SpecialCharTok{\&\&} \FunctionTok{is.null}\NormalTok{(acc\_name)) }\FunctionTok{stop}\NormalTok{(}\StringTok{"No accuracy metric found in history."}\NormalTok{)}
  
  \ControlFlowTok{if}\NormalTok{ (metric }\SpecialCharTok{==} \StringTok{"accuracy"}\NormalTok{) \{}
\NormalTok{    train }\OtherTok{\textless{}{-}}\NormalTok{ metrics[[acc\_name]]}
\NormalTok{    val   }\OtherTok{\textless{}{-}}\NormalTok{ metrics[[}\FunctionTok{paste0}\NormalTok{(}\StringTok{"val\_"}\NormalTok{, acc\_name)]]}
\NormalTok{    ylab }\OtherTok{\textless{}{-}} \StringTok{"Accuracy"}
\NormalTok{  \} }\ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{    train }\OtherTok{\textless{}{-}}\NormalTok{ metrics}\SpecialCharTok{$}\NormalTok{loss}
\NormalTok{    val   }\OtherTok{\textless{}{-}}\NormalTok{ metrics}\SpecialCharTok{$}\NormalTok{val\_loss}
\NormalTok{    ylab }\OtherTok{\textless{}{-}} \StringTok{"Loss"}
\NormalTok{  \}}
  
\NormalTok{  epochs }\OtherTok{\textless{}{-}} \FunctionTok{seq\_along}\NormalTok{(train)}
\NormalTok{  ylim }\OtherTok{\textless{}{-}} \FunctionTok{range}\NormalTok{(}\FunctionTok{c}\NormalTok{(train, val), }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
  
  \FunctionTok{plot}\NormalTok{(epochs, train, }\AttributeTok{type =} \StringTok{"o"}\NormalTok{, }\AttributeTok{pch =} \DecValTok{16}\NormalTok{, }\AttributeTok{ylim =}\NormalTok{ ylim,}
       \AttributeTok{xlab =} \StringTok{"Epoch"}\NormalTok{, }\AttributeTok{ylab =}\NormalTok{ ylab, }\AttributeTok{main =} \FunctionTok{paste}\NormalTok{(}\StringTok{"Training vs Validation"}\NormalTok{, ylab))}
  \FunctionTok{lines}\NormalTok{(epochs, val, }\AttributeTok{type =} \StringTok{"o"}\NormalTok{, }\AttributeTok{pch =} \DecValTok{17}\NormalTok{)}
  \FunctionTok{legend}\NormalTok{(}\StringTok{"bottomright"}\NormalTok{, }\AttributeTok{legend =} \FunctionTok{c}\NormalTok{(}\StringTok{"train"}\NormalTok{, }\StringTok{"validation"}\NormalTok{), }\AttributeTok{pch =} \FunctionTok{c}\NormalTok{(}\DecValTok{16}\NormalTok{,}\DecValTok{17}\NormalTok{), }\AttributeTok{lty =} \DecValTok{1}\NormalTok{)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Usage:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot\_history}\NormalTok{(history\_baseline, }\StringTok{"accuracy"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{Assignment1_files/figure-latex/unnamed-chunk-14-1.pdf}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot\_history}\NormalTok{(history\_baseline, }\StringTok{"loss"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{Assignment1_files/figure-latex/unnamed-chunk-14-2.pdf}}
2) Pretty ggplot2 plot (single history)

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# requires packages}
\ControlFlowTok{if}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{requireNamespace}\NormalTok{(}\StringTok{"ggplot2"}\NormalTok{, }\AttributeTok{quietly =} \ConstantTok{TRUE}\NormalTok{)) }\FunctionTok{install.packages}\NormalTok{(}\StringTok{"ggplot2"}\NormalTok{)}
\ControlFlowTok{if}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{requireNamespace}\NormalTok{(}\StringTok{"tidyr"}\NormalTok{, }\AttributeTok{quietly =} \ConstantTok{TRUE}\NormalTok{)) }\FunctionTok{install.packages}\NormalTok{(}\StringTok{"tidyr"}\NormalTok{)}
\FunctionTok{library}\NormalTok{(ggplot2); }\FunctionTok{library}\NormalTok{(tidyr)}

\NormalTok{plot\_history\_gg }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(history, }\AttributeTok{metric =} \FunctionTok{c}\NormalTok{(}\StringTok{"accuracy"}\NormalTok{, }\StringTok{"loss"}\NormalTok{)) \{}
\NormalTok{  metric }\OtherTok{\textless{}{-}} \FunctionTok{match.arg}\NormalTok{(metric)}
\NormalTok{  metrics }\OtherTok{\textless{}{-}}\NormalTok{ history}\SpecialCharTok{$}\NormalTok{metrics}
\NormalTok{  acc\_name }\OtherTok{\textless{}{-}} \ControlFlowTok{if}\NormalTok{ (}\SpecialCharTok{!}\FunctionTok{is.null}\NormalTok{(metrics}\SpecialCharTok{$}\NormalTok{accuracy)) }\StringTok{"accuracy"} \ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{ (}\SpecialCharTok{!}\FunctionTok{is.null}\NormalTok{(metrics}\SpecialCharTok{$}\NormalTok{acc)) }\StringTok{"acc"} \ControlFlowTok{else} \ConstantTok{NULL}
  \ControlFlowTok{if}\NormalTok{ (metric }\SpecialCharTok{==} \StringTok{"accuracy"} \SpecialCharTok{\&\&} \FunctionTok{is.null}\NormalTok{(acc\_name)) }\FunctionTok{stop}\NormalTok{(}\StringTok{"No accuracy metric found."}\NormalTok{)}
  
  \ControlFlowTok{if}\NormalTok{ (metric }\SpecialCharTok{==} \StringTok{"accuracy"}\NormalTok{) \{}
\NormalTok{    train }\OtherTok{\textless{}{-}}\NormalTok{ metrics[[acc\_name]]}
\NormalTok{    val   }\OtherTok{\textless{}{-}}\NormalTok{ metrics[[}\FunctionTok{paste0}\NormalTok{(}\StringTok{"val\_"}\NormalTok{, acc\_name)]]}
\NormalTok{    ylab }\OtherTok{\textless{}{-}} \StringTok{"Accuracy"}
\NormalTok{  \} }\ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{    train }\OtherTok{\textless{}{-}}\NormalTok{ metrics}\SpecialCharTok{$}\NormalTok{loss}
\NormalTok{    val   }\OtherTok{\textless{}{-}}\NormalTok{ metrics}\SpecialCharTok{$}\NormalTok{val\_loss}
\NormalTok{    ylab }\OtherTok{\textless{}{-}} \StringTok{"Loss"}
\NormalTok{  \}}
  
\NormalTok{  df }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
    \AttributeTok{epoch =} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(train),}
    \AttributeTok{train =}\NormalTok{ train,}
    \AttributeTok{validation =}\NormalTok{ val}
\NormalTok{  )}
\NormalTok{  df\_long }\OtherTok{\textless{}{-}} \FunctionTok{pivot\_longer}\NormalTok{(df, }\AttributeTok{cols =} \FunctionTok{c}\NormalTok{(}\StringTok{"train"}\NormalTok{,}\StringTok{"validation"}\NormalTok{), }\AttributeTok{names\_to =} \StringTok{"set"}\NormalTok{, }\AttributeTok{values\_to =} \StringTok{"value"}\NormalTok{)}
  
  \FunctionTok{ggplot}\NormalTok{(df\_long, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ epoch, }\AttributeTok{y =}\NormalTok{ value, }\AttributeTok{color =}\NormalTok{ set)) }\SpecialCharTok{+}
    \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{size =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \FunctionTok{paste}\NormalTok{(}\StringTok{"Training vs Validation"}\NormalTok{, ylab), }\AttributeTok{y =}\NormalTok{ ylab, }\AttributeTok{x =} \StringTok{"Epoch"}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{theme\_minimal}\NormalTok{()}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Usage:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot\_history\_gg}\NormalTok{(history\_baseline, }\StringTok{"accuracy"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{Assignment1_files/figure-latex/unnamed-chunk-16-1.pdf}}
3) Compare multiple histories (ggplot) --- great for experiments

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# histories: named list of history objects, e.g. list(baseline = history\_baseline, one = history\_1layer)}
\NormalTok{compare\_histories }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(histories, }\AttributeTok{metric =} \FunctionTok{c}\NormalTok{(}\StringTok{"accuracy"}\NormalTok{, }\StringTok{"loss"}\NormalTok{)) \{}
\NormalTok{  metric }\OtherTok{\textless{}{-}} \FunctionTok{match.arg}\NormalTok{(metric)}
  \FunctionTok{library}\NormalTok{(dplyr); }\FunctionTok{library}\NormalTok{(tidyr); }\FunctionTok{library}\NormalTok{(ggplot2)}
  
\NormalTok{  df\_all }\OtherTok{\textless{}{-}} \FunctionTok{lapply}\NormalTok{(}\FunctionTok{names}\NormalTok{(histories), }\ControlFlowTok{function}\NormalTok{(nm) \{}
\NormalTok{    h }\OtherTok{\textless{}{-}}\NormalTok{ histories[[nm]]}\SpecialCharTok{$}\NormalTok{metrics}
\NormalTok{    acc\_name }\OtherTok{\textless{}{-}} \ControlFlowTok{if}\NormalTok{ (}\SpecialCharTok{!}\FunctionTok{is.null}\NormalTok{(h}\SpecialCharTok{$}\NormalTok{accuracy)) }\StringTok{"accuracy"} \ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{ (}\SpecialCharTok{!}\FunctionTok{is.null}\NormalTok{(h}\SpecialCharTok{$}\NormalTok{acc)) }\StringTok{"acc"} \ControlFlowTok{else} \ConstantTok{NULL}
    \ControlFlowTok{if}\NormalTok{ (metric }\SpecialCharTok{==} \StringTok{"accuracy"} \SpecialCharTok{\&\&} \FunctionTok{is.null}\NormalTok{(acc\_name)) }\FunctionTok{stop}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"No accuracy metric for"}\NormalTok{, nm))}
    
    \ControlFlowTok{if}\NormalTok{ (metric }\SpecialCharTok{==} \StringTok{"accuracy"}\NormalTok{) \{}
\NormalTok{      train }\OtherTok{\textless{}{-}}\NormalTok{ h[[acc\_name]]}
\NormalTok{      val   }\OtherTok{\textless{}{-}}\NormalTok{ h[[}\FunctionTok{paste0}\NormalTok{(}\StringTok{"val\_"}\NormalTok{, acc\_name)]]}
\NormalTok{      ylab }\OtherTok{\textless{}{-}} \StringTok{"Accuracy"}
\NormalTok{    \} }\ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{      train }\OtherTok{\textless{}{-}}\NormalTok{ h}\SpecialCharTok{$}\NormalTok{loss}
\NormalTok{      val   }\OtherTok{\textless{}{-}}\NormalTok{ h}\SpecialCharTok{$}\NormalTok{val\_loss}
\NormalTok{      ylab }\OtherTok{\textless{}{-}} \StringTok{"Loss"}
\NormalTok{    \}}
\NormalTok{    df }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{epoch =} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(train),}
                     \AttributeTok{train =}\NormalTok{ train,}
                     \AttributeTok{validation =}\NormalTok{ val,}
                     \AttributeTok{model =}\NormalTok{ nm)}
    \FunctionTok{pivot\_longer}\NormalTok{(df, }\AttributeTok{cols =} \FunctionTok{c}\NormalTok{(}\StringTok{"train"}\NormalTok{,}\StringTok{"validation"}\NormalTok{), }\AttributeTok{names\_to =} \StringTok{"set"}\NormalTok{, }\AttributeTok{values\_to =} \StringTok{"value"}\NormalTok{)}
\NormalTok{  \})}
  
\NormalTok{  df\_combined }\OtherTok{\textless{}{-}} \FunctionTok{bind\_rows}\NormalTok{(df\_all)}
  
  \FunctionTok{ggplot}\NormalTok{(df\_combined, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ epoch, }\AttributeTok{y =}\NormalTok{ value, }\AttributeTok{color =}\NormalTok{ model, }\AttributeTok{linetype =}\NormalTok{ set)) }\SpecialCharTok{+}
    \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{size =} \FloatTok{0.8}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \FunctionTok{paste}\NormalTok{(}\StringTok{"Compare models —"}\NormalTok{, metric), }\AttributeTok{x =} \StringTok{"Epoch"}\NormalTok{, }\AttributeTok{y =}\NormalTok{ metric) }\SpecialCharTok{+}
    \FunctionTok{theme\_minimal}\NormalTok{()}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Usage:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{histories\_list }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}
  \AttributeTok{baseline =}\NormalTok{ history\_baseline,}
  \AttributeTok{one\_layer =}\NormalTok{ history\_1layer,}
  \AttributeTok{dropout =}\NormalTok{ history\_dropout}
\NormalTok{)}
\FunctionTok{compare\_histories}\NormalTok{(histories\_list, }\StringTok{"accuracy"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Attaching package: 'dplyr'
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:stats':
## 
##     filter, lag
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union
\end{verbatim}

\pandocbounded{\includegraphics[keepaspectratio]{Assignment1_files/figure-latex/unnamed-chunk-18-1.pdf}}

\end{document}
